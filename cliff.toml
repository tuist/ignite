# Configuration for git-cliff
# See: https://git-cliff.org/docs/configuration

[changelog]
header = """
# Changelog

All notable changes to this project will be documented in this file.

"""
body = """
<!-- RELEASE NOTES START -->
{% if version -%}
    ## [{{ version }}] - {{ timestamp | date(format="%Y-%m-%d") }}
{% else -%}
    ## [Unreleased]
{% endif -%}

{% for group, commits in commits | group_by(attribute="group") %}
    ### {{ group | upper_first }}
    {% for commit in commits -%}
        {%- if commit.scope -%}
            - **{{ commit.scope }}**: {{ commit.message | upper_first | trim }}
            {%- if commit.breaking %} [**breaking**]{% endif -%}
            {%- if commit.github.username %} by @{{ commit.github.username }}{%- endif -%}
            {%- if commit.github.pr_number %} in [#{{ commit.github.pr_number }}](https://github.com/tuist/ignite/pull/{{ commit.github.pr_number }}){%- endif -%}
        {%- else -%}
            - {{ commit.message | upper_first | trim }}
            {%- if commit.breaking %} [**breaking**]{% endif -%}
            {%- if commit.github.username %} by @{{ commit.github.username }}{%- endif -%}
            {%- if commit.github.pr_number %} in [#{{ commit.github.pr_number }}](https://github.com/tuist/ignite/pull/{{ commit.github.pr_number }}){%- endif -%}
        {%- endif %}
    {%- endfor %}
{% endfor %}

{%- if github.contributors | filter(attribute="is_first_time", value=true) | length != 0 %}
    ### New Contributors
    {%- for contributor in github.contributors | filter(attribute="is_first_time", value=true) %}
        - @{{ contributor.username }} made their first contribution
        {%- if contributor.pr_number %} in [#{{ contributor.pr_number }}](https://github.com/tuist/ignite/pull/{{ contributor.pr_number }}){%- endif %}
    {%- endfor %}
{%- endif -%}

{% if version -%}
    {% if previous.version -%}
        **Full Changelog**: https://github.com/tuist/ignite/compare/{{ previous.version }}...{{ version }}
    {% else -%}
        **Full Changelog**: https://github.com/tuist/ignite/commits/{{ version }}
    {% endif -%}
{% else -%}
    {% if previous.version -%}
        **Full Changelog**: https://github.com/tuist/ignite/compare/{{ previous.version }}...HEAD
    {% else -%}
        **Full Changelog**: https://github.com/tuist/ignite/commits
    {% endif -%}
{% endif %}
"""
footer = """
<!-- generated by git-cliff -->
"""
trim = true
postprocessors = [
    { pattern = '\$REPO', replace = "https://github.com/tuist/ignite" },
]

[git]
conventional_commits = true
filter_unconventional = true
split_commits = false
commit_preprocessors = [
    { pattern = '\((\w+\s)?#([0-9]+)\)', replace = "([#${2}](<REPO>/issues/${2}))" },
]
commit_parsers = [
    { message = "^feat", group = "<!-- 0 -->⛰️  Features" },
    { message = "^fix", group = "<!-- 1 -->🐛 Bug Fixes" },
    { message = "^doc", group = "<!-- 2 -->📚 Documentation" },
    { message = "^perf", group = "<!-- 3 -->⚡ Performance" },
    { message = "^refactor", group = "<!-- 4 -->🔨 Refactor" },
    { message = "^style", group = "<!-- 5 -->🎨 Styling" },
    { message = "^test", group = "<!-- 6 -->🧪 Testing" },
    { message = "^chore\\(release\\): prepare for", skip = true },
    { message = "^chore\\(deps.*\\)", skip = true },
    { message = "^chore\\(pr\\)", skip = true },
    { message = "^chore\\(pull\\)", skip = true },
    { message = "^chore|^ci", group = "<!-- 7 -->🏗️ Miscellaneous Tasks" },
    { body = ".*security", group = "<!-- 8 -->🔐 Security" },
    { message = "^revert", group = "<!-- 9 -->⏪ Revert" },
]
protect_breaking_commits = false
filter_commits = false
tag_pattern = "[0-9].*"
skip_tags = "beta|alpha"
ignore_tags = ""
sort_commits = "newest"

[remote.github]
owner = "tuist"
repo = "ignite"

[bump]
breaking_always_bump_major = true
features_always_bump_minor = true
initial_tag = "0.1.0"